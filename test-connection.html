<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×‘×“×™×§×ª ×—×™×‘×•×¨ ×œ-Google Sheets</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
            padding: 30px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        input, button {
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            font-size: 16px;
        }
        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            opacity: 0.9;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª ×‘×“×™×§×ª ×—×™×‘×•×¨ ×œ-Google Sheets</h1>
        
        <div class="test-form">
            <input type="text" id="testName" placeholder="×”×›× ×¡ ×©× ×œ×‘×“×™×§×”" value="×‘×“×™×§×”">
            <input type="email" id="testEmail" placeholder="×”×›× ×¡ ××™×ž×™×™×œ ×œ×‘×“×™×§×”" value="test@example.com">
            <button id="sendBtn" onclick="sendTestData()">×©×œ×— × ×ª×•× ×™ ×‘×“×™×§×”</button>
        </div>
        
        <div id="status" class="status"></div>
        
        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
            <h3 style="color: #666; margin-bottom: 10px;">×ž×™×“×¢ ×¢×œ ×”×—×™×‘×•×¨:</h3>
            <p style="color: #888; font-size: 14px; line-height: 1.6;">
                URL: <span style="color: #667eea; word-break: break-all;">https://script.google.com/.../exec</span><br>
                Method: POST<br>
                Mode: no-cors<br>
                Status: <span id="connectionStatus">×ž×ž×ª×™×Ÿ ×œ×‘×“×™×§×”...</span>
            </p>
        </div>
    </div>

    <script>
        async function sendTestData() {
            const btn = document.getElementById('sendBtn');
            const status = document.getElementById('status');
            const connectionStatus = document.getElementById('connectionStatus');
            
            // Get form values
            const testName = document.getElementById('testName').value;
            const testEmail = document.getElementById('testEmail').value;
            
            if (!testName || !testEmail) {
                showStatus('error', '×× × ×ž×œ× ××ª ×›×œ ×”×©×“×•×ª');
                return;
            }
            
            // Disable button
            btn.disabled = true;
            btn.textContent = '×©×•×œ×—...';
            connectionStatus.textContent = '×ž×ª×—×‘×¨...';
            
            // Prepare test data
            const testData = {
                timestamp: new Date().toLocaleString('he-IL'),
                q1: '×‘×“×™×§×ª ×—×™×‘×•×¨',
                q2: '×–×” ×ž×¡×š ×‘×“×™×§×”',
                q3: '×ž×•×˜×™×‘×¦×™×” ×œ×‘×“×™×§×”',
                q4: '×¤×—×“×™ ×‘×“×™×§×”',
                q5: '×ª×—×•× ×‘×“×™×§×”',
                q6: '×©×™×¨×•×ª ×‘×“×™×§×”',
                q7: 'B2C',
                q8: '×™×™×—×•×“ ×‘×“×™×§×”',
                q9: '×¨×§ ×¨×¢×™×•×Ÿ',
                q10: '×¢×“ 10K',
                q11: '×”×•×Ÿ ×¢×¦×ž×™',
                q12: '100% ×ž×•×›×Ÿ',
                q13: '×©×™×•×•×§ ×“×™×’×™×˜×œ×™, ×ª×ž×—×•×¨',
                q14: '2-3 ×©×¢×•×ª',
                q15: '×‘×“×™×§×ª ×ž×¢×¨×›×ª',
                q16: '×›×Ÿ',
                q17a: testName,
                q17b: '050-1234567',
                q17c: testEmail,
                q17d: '',
                q18: '×ž××©×¨'
            };
            
            try {
                // Google Apps Script URL
                const scriptUrl = 'https://script.google.com/macros/s/AKfycbyxpwO1wPunQLYMKqcDYSFXcbrRFUC__nJVAxVF2MqTsEge-AVSvi7mNdgdnDHs9hFucw/exec';
                
                console.log('Sending data to:', scriptUrl);
                console.log('Data:', testData);
                
                // Send data
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                // With no-cors, we can't read the response, so we assume success
                connectionStatus.textContent = '× ×©×œ×— ×‘×”×¦×œ×—×”!';
                connectionStatus.style.color = '#28a745';
                
                showStatus('success', 'âœ… ×”× ×ª×•× ×™× × ×©×œ×—×• ×‘×”×¦×œ×—×”! ×‘×“×•×§ ××ª ×”-Google Sheet ×©×œ×š.');
                
                console.log('Data sent successfully!');
                
                // Add timestamp to success message
                setTimeout(() => {
                    status.innerHTML += `<br><small style="opacity: 0.7;">× ×©×œ×— ×‘: ${new Date().toLocaleString('he-IL')}</small>`;
                }, 100);
                
            } catch (error) {
                console.error('Error:', error);
                connectionStatus.textContent = '×©×’×™××” ×‘×—×™×‘×•×¨';
                connectionStatus.style.color = '#dc3545';
                
                showStatus('error', 'âŒ ×©×’×™××” ×‘×©×œ×™×—×”. ×‘×“×•×§ ××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜.');
                
            } finally {
                // Re-enable button
                btn.disabled = false;
                btn.textContent = '×©×œ×— × ×ª×•× ×™ ×‘×“×™×§×”';
            }
        }
        
        function showStatus(type, message) {
            const status = document.getElementById('status');
            status.className = `status ${type} show`;
            status.innerHTML = message;
        }
        
        // Test connection on page load
        window.addEventListener('DOMContentLoaded', () => {
            console.log('Test page loaded. Ready to test Google Sheets connection.');
            console.log('Script URL configured:', 'https://script.google.com/.../exec');
        });
        
        // Allow Enter key to submit
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !document.getElementById('sendBtn').disabled) {
                sendTestData();
            }
        });
    </script>
</body>
</html>